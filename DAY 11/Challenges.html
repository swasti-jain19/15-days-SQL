<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DAY 11 - Challenges</title>
</head>

<body>
    <p>
        <strong>Question 1:</strong>
    </p>
    <p>Level: Moderate</p>
    <p>Topic: Aggregation</p>
    <p>Task: Write a query that returns the transaction_id, payment_type, customer_id, and price_in_transaction. Additionally, for each customer, calculate the total price of all their transactions.</p>

    <p>
        <br>
    </p>
    <p>
        <strong>Question 2:</strong>
    </p>
    <p>Level: Moderate</p>
    <p>Topic: Window Functions</p>
    <p>Task: Write a query that returns the transaction_id, payment_type, customer_id, and price_in_transaction. Additionally, calculate the total price of transactions for each customer using a window function.</p>

    <p>
        <br>
    </p>
    <p>
        <strong>Question 3:</strong>
    </p>
    <p>Level: Moderate</p>
    <p>Topic: Aggregation + Ordering</p>
    <p>Task: Write a query that returns the list of movies including title, length, category, average length of movies in that category. Order the results by film_id.</p>

    <p>
        <br>
    </p>
    <p>
        <strong>Question 4:</strong>
    </p>
    <p>Level: Moderate</p>
    <p>Topic: Aggregation + Ordering</p>
    <p>Task: Write a query that returns all payment details, including the number of payments that were made by this customer and that amount. Order the results by payment_id.</p>

    <p>
        <br>
    </p>
    <p>
        <strong>Question 5:</strong>
    </p>
    <p>Level: Advanced</p>
    <p>Topic: Running Total</p>
    <p>Task: Write a query that returns the running total of how late the flights are (difference between actual_arrival and scheduled arrival) ordered by flight_id including the departure airport.</p>

    <p>
        <br>
    </p>
    <p>
        <strong>Question 6:</strong>
    </p>
    <p>Level: Advanced</p>
    <p>Topic: Partitioning + Running Total</p>
    <p>Task: Calculate the same running total as in Question 5 but partition also by the departure airport.</p>

    <p>
        <br>
    </p>
    <p>
        <strong>Question 7:</strong>
    </p>
    <p>Level: Advanced</p>
    <p>Topic: Ranking</p>
    <p>Task: Write a query that returns the customers' name, the country, and how many payments they have. Use the existing view "customer_list." Afterwards, create a ranking of the top customers with most sales for each country. Filter the results to only the top 3 customers per country.</p>

    <p>
        <br>
    </p>
    <p>
        <strong>Question 8:</strong>
    </p>
    <p>Level: Advanced</p>
    <p>Topic: LAG + Calculations</p>
    <p>Task: Write a query that returns the revenue of the day and the revenue of the previous day. Calculate the difference and the percentage growth compared to the previous day.</p>

    <p>
        <br>
    </p>
    <p>
        <strong>Question 9:</strong>
    </p>
    <p>Level: Advanced</p>
    <p>Topic: Partitioning + Percentages</p>
    <p>Task: Write a query that calculates the share of revenue each staff_id makes per customer. The result should include first_name, last_name, staff_id, total revenue, and percentage of total revenue.</p>

</body>
</html>

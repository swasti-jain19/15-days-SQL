<p><strong>Task 1 </strong></p><p>Difficulty: Moderate</p><p><br></p><p><strong>Task 1.1</strong></p><p>In your company there hasn't been a database table with all the employee information yet.</p><p>You need to set up the table called employees in the following way:</p><p><br></p><figure><img src="https://img-c.udemycdn.com/redactor/raw/article_lecture/2022-08-10_14-06-45-9481317717076af04727664bc6344aec.png"></figure><p><br></p><p>There should be NOT NULL constraints for the following columns:</p><p>first_name,</p><p>last_name ,</p><p>job_position,</p><p>start_date DATE,</p><p>birth_date DATE </p><p><br></p><p><strong>Task 1.2</strong></p><p>Set up an additional table called departments in the following way:</p><figure><img height="47" src="https://img-c.udemycdn.com/redactor/raw/article_lecture/2022-08-10_14-06-45-ba2470af10baa81827a89a554c5f57c0.png" width="257"></figure><p>Additionally no column should allow nulls.</p><p><br></p><p><strong>Task 2</strong></p><p>Difficulty: Moderate</p><p><br></p><p>Alter the employees table in the following way:</p><p>- Set the column department_id to not null.</p><p>- Add a default value of CURRENT_DATE to the column start_date.</p><p>- Add the column end_date with an appropriate data type (one that you think makes sense).</p><p>- Add a constraint called birth_check that doesn't allow birth dates that are in the future.</p><p>- Rename the column job_position to position_title.</p><p><br></p><p><strong>Task 3</strong></p><p>Difficulty: Moderate </p><p><br></p><p><strong>Task 3.1</strong></p><p><br></p><p>Insert the following values into the <em>employees </em>table.</p><p>There will be most likely an error when you try to insert the values. </p><p>So, try to insert the values and then fix the error. </p><p><em>Columns: </em></p><pre class="prettyprint linenums">(emp_id,first_name,last_name,position_title,salary,start_date,birth_date,store_id,department_id,manager_id,end_date)</pre><p><br></p><p><em>Values:</em></p><pre class="prettyprint linenums">(1,'Morrie','Conaboy','CTO',21268.94,'2005-04-30','1983-07-10',1,1,NULL,NULL),
(2,'Miller','McQuarter','Head of BI',14614.00,'2019-07-23','1978-11-09',1,1,1,NULL),
(3,'Christalle','McKenny','Head of Sales',12587.00,'1999-02-05','1973-01-09',2,3,1,NULL),
(4,'Sumner','Seares','SQL Analyst',9515.00,'2006-05-31','1976-08-03',2,1,6,NULL),
(5,'Romain','Hacard','BI Consultant',7107.00,'2012-09-24','1984-07-14',1,1,6,NULL),
(6,'Ely','Luscombe','Team Lead Analytics',12564.00,'2002-06-12','1974-08-01',1,1,2,NULL),
(7,'Clywd','Filyashin','Senior SQL Analyst',10510.00,'2010-04-05','1989-07-23',2,1,2,NULL),
(8,'Christopher','Blague','SQL Analyst',9428.00,'2007-09-30','1990-12-07',2,2,6,NULL),
(9,'Roddie','Izen','Software Engineer',4937.00,'2019-03-22','2008-08-30',1,4,6,NULL),
(10,'Ammamaria','Izhak','Customer Support',2355.00,'2005-03-17','1974-07-27',2,5,3,2013-04-14),
(11,'Carlyn','Stripp','Customer Support',3060.00,'2013-09-06','1981-09-05',1,5,3,NULL),
(12,'Reuben','McRorie','Software Engineer',7119.00,'1995-12-31','1958-08-15',1,5,6,NULL),
(13,'Gates','Raison','Marketing Specialist',3910.00,'2013-07-18','1986-06-24',1,3,3,NULL),
(14,'Jordanna','Raitt','Marketing Specialist',5844.00,'2011-10-23','1993-03-16',2,3,3,NULL),
(15,'Guendolen','Motton','BI Consultant',8330.00,'2011-01-10','1980-10-22',2,3,6,NULL),
(16,'Doria','Turbat','Senior SQL Analyst',9278.00,'2010-08-15','1983-01-11',1,1,6,NULL),
(17,'Cort','Bewlie','Project Manager',5463.00,'2013-05-26','1986-10-05',1,5,3,NULL),
(18,'Margarita','Eaden','SQL Analyst',5977.00,'2014-09-24','1978-10-08',2,1,6,2020-03-16),
(19,'Hetty','Kingaby','SQL Analyst',7541.00,'2009-08-17','1999-04-25',1,2,6,'NULL'),
(20,'Lief','Robardley','SQL Analyst',8981.00,'2002-10-23','1971-01-25',2,3,6,2016-07-01),
(21,'Zaneta','Carlozzi','Working Student',1525.00,'2006-08-29','1995-04-16',1,3,6,2012-02-19),
(22,'Giana','Matz','Working Student',1036.00,'2016-03-18','1987-09-25',1,3,6,NULL),
(23,'Hamil','Evershed','Web Developper',3088.00,'2022-02-03','2012-03-30',1,4,2,NULL),
(24,'Lowe','Diamant','Web Developper',6418.00,'2018-12-31','2002-09-07',1,4,2,NULL),
(25,'Jack','Franklin','SQL Analyst',6771.00,'2013-05-18','2005-10-04',1,2,2,NULL),
(26,'Jessica','Brown','SQL Analyst',8566.00,'2003-10-23','1965-01-29',1,1,2,NULL)</pre><p><br></p><p><br></p><p><strong>Task 3.2</strong></p><p>Insert the following values into the departments table.</p><p><br></p><figure><img height="238" src="https://img-c.udemycdn.com/redactor/raw/article_lecture/2022-08-10_14-06-45-028cd4a57cda9324639786daf3ae607d.png" width="400"></figure><p><br></p><p><strong>Task 4</strong></p><p>Difficulty: Moderate</p><p><br></p><p><strong>Task 4.1</strong></p><p>Jack Franklin gets promoted to 'Senior SQL Analyst' and the salary raises to 7200.</p><p>Update the values accordingly.</p><p><br></p><p><strong>Task 4.2</strong></p><p>The responsible people decided to rename the position_title Customer Support to Customer Specialist.</p><p>Update the values accordingly.</p><p><br></p><p><strong>Task 4.3</strong></p><p>All SQL Analysts including Senior SQL Analysts get a raise of 6%.</p><p>Upate the salaries accordingly.</p><p><br></p><p><strong>Task 4.4</strong></p><p><em>Question:</em></p><p>What is the average salary of a SQL Analyst in the company (excluding Senior SQL Analyst)? </p><p><br></p><p><em>Answer:</em></p><p>8834.75</p><p><br></p><p><strong>Task 5</strong></p><p>Difficulty: Advanced</p><p><br></p><p><strong>Task 5.1</strong></p><p>Write a query that adds a column called manager that contains&nbsp; first_name and last_name (in one column) in the data output.</p><p>Secondly, add a column called is_active with 'false' if the employee has left the company already, otherwise the value is 'true'.</p><p><br></p><p><strong>Task 5.2</strong></p><p>Create a view called v_employees_info from that previous query.</p><p><br></p><p><strong>Task 6</strong></p><p>Difficulty: Moderate</p><p><br></p><p>Write a query that returns the average salaries for each positions with appropriate roundings.</p><p><br></p><p><em>Question:</em> </p><p>What is the average salary for a Software Engineer in the company.</p><p><br></p><p><em>Answer:</em></p><p>6028.00</p><p><br></p><p><strong>Task 7 </strong></p><p>Difficulty: Moderate</p><p><br></p><p>Write a query that returns the average salaries per division.</p><p><br></p><p><em>Question:</em></p><p>What is the average salary in the Sales department?</p><p><br></p><p>Answer:</p><p>6107.41</p><p><br></p><p><strong>Task 8</strong></p><p>Difficulty: Advanced</p><p><br></p><p><strong>Task 8.1</strong></p><p>Write a query that returns the following:</p><p>emp_id,</p><p>first_name,</p><p>last_name,</p><p>position_title,</p><p>salary</p><p>and a column that returns the average salary for every job_position. </p><p><br></p><p>Order the results by the emp_id.</p><p><br></p><figure><img height="171" src="https://img-c.udemycdn.com/redactor/raw/article_lecture/2022-08-10_14-06-45-ee080b7812d315118f52b676dfbfac4b.png" width="712"></figure><p><br></p><p><br></p><p><strong>Task 8.2</strong></p><p>Difficulty: Advanced to Pro</p><p><br></p><p>How many people earn less than there avg_position_salary?</p><p>Write a query that answers that question. </p><p>Ideally the output just shows that number directly.</p><p><br></p><p><em>Answer:</em> </p><p>9</p><p><br></p><p><strong>Task 9:</strong></p><p>Difficulty: Advanced</p><p>Write a query that returns a running total of the salary development ordered by the start_date.</p><p>In your calculation, disregard that fact that people have left the company (write the query as if they were still working for the company).</p><p><br></p><figure><img src="https://img-c.udemycdn.com/redactor/raw/article_lecture/2022-08-10_14-06-45-cd7ebf85b982ed6c458ec1ba79765054.png"></figure><p><br></p><p><em>Question:</em></p><p>What was the total salary after 2018-12-31?</p><p><br></p><p><em>Answer:</em></p><p>180202.70</p><p><br></p><p><strong>Task 10:</strong></p><p>Difficulty: Pro / Very difficult </p><p>Create the same running total but now also considder the fact that people were leaving the company.</p><p><br></p><p><em>Note:</em></p><p>This challenge is actually very difficult. </p><p>Don't worry if you can't solve it you are not expected to do so.</p><p>It is possible to solve the challenge even without the hints.</p><p>If you want you can try to solve it using the hints and it is still a difficult challenge.</p><p><br></p><p><em>Question:</em></p><p>What was the total salary after 2018-12-31?</p><p><br></p><p><em>Answer:</em></p><p>166802.84</p><p><br></p><p><em>Hint 1: <br></em>Use the view v_employees_info.</p><p><em>Hint 2: <br></em>Create to separate queries one with all employees and one with the people that have already left</p><p><em>Hint 3: <br></em>In the first query use start_date and in the second query use end_date instead of the start_date</p><p><em>Hint 4: <br></em>Multiply the salary of the second query with (-1).</p><p><em>Hint 5: <br></em>Create a subquery from that UNION and use a window function in that to create the running total.</p><p><br></p><p><strong>Task 11</strong></p><p>Difficulty: Advanced to Pro</p><p><br></p><p><strong>Task 11.1</strong></p><p>Write a query that outputs only the top earner per position_title including first_name and position_title and their salary.</p><figure><img height="219" src="https://img-c.udemycdn.com/redactor/raw/article_lecture/2022-08-10_14-06-46-64c69bb4a9cabf9cc434a4e754dc7b93.png" width="485"></figure><p><br></p><p><em>Question:</em></p><p>What is the top earner with the position_title SQL Analyst?</p><p><br></p><p><em>Answer:</em></p><p>Sumner with 10085.90</p><p><br></p><p><strong>Task 11.2</strong></p><p>Add also the average salary per position_title.</p><figure><img height="187" src="https://img-c.udemycdn.com/redactor/raw/article_lecture/2022-08-10_14-06-46-8a896f85dd6552df023234ecbc02897b.png" width="606"></figure><p><br></p><p><strong>Task 11.3</strong></p><p>Remove those employees from the output of the previous query that have the same salary as the average of their position_title.</p><p>These are the people that are the only ones with their position_title. </p><p><br></p><p><strong>Task 12</strong></p><p><br></p><p>Difficulty: Pro</p><p><br></p><p>Write a query that returns all meaningful aggregations of</p><p>- sum of salary, </p><p>- number of employees,</p><p>- average salary</p><p>grouped by all meaningful combinations of </p><p>- division,</p><p>- department,</p><p>- position_title.</p><p><br></p><p>Consider the levels of hierarchies in a meaningful way.</p><p><br></p><figure><img height="179" src="https://img-c.udemycdn.com/redactor/raw/article_lecture/2022-08-10_14-06-46-32f81b87932bc2494dfa2409327905ec.png" width="664"></figure><p><br></p><p><strong>Task 13</strong></p><p>Difficulty: Advanced to Pro</p><p><br></p><p>Write a query that returns all employees (emp_id) including their position_title, department their salary and the rank of that salary partitioned by department.</p><p>The highest salary per division should have rank 1.</p><p><br></p><figure><img height="205" src="https://img-c.udemycdn.com/redactor/raw/article_lecture/2022-08-10_14-06-46-ee4c62ade30194de367965d239f4229e.png" width="620"></figure><p><br></p><p><em>Question: </em></p><p>Which employee (emp_id) is in rank 7 in the department Analytics?</p><p><br></p><p><em>Answer:</em></p><p>emp_id 26</p><p><br></p><p><strong>Task 14</strong></p><p>Difficulty: Pro</p><p><br></p><p>Write a query that returns only the top earner of each department including </p><p>their emp_id, position_title, department and their salary. </p><p><br></p><p><em>Question: </em></p><p>Which employee (emp_id) is the top earner in the department Finance?</p><p><br></p><p><em>Answer:</em></p><p>emp_id 8</p>